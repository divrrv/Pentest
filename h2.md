# h0 Sniff-n-Scan

### x) Lue/katso ja tiivistä

### a) Fuff

 - Alussa latasin wget, ffuf ja Seclist

#### komennot

    sudo apt-get install wget
    wget https://github.com/ffuf/ffuf/releases/download/v2.0.0/ffuf_2.0.0_linux_amd64.tar.gz
    tar -xf ffuf_2.0.0_linux_amd64.tar.gz
    wget https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/common.txt

 - latasin dirtfuzt-1 sivulta https://terokarvinen.com/2023/fuzz-urls-find-hidden-directories/
 - annoin oikeudet ja ajat tiedoston dirtfuzt-1

#### komennot

    chmod u+x dirfuzt-0
    ./dirfuzt-1

 - toisessa terminaalissa

#### komennot

    ./ffuf -w common.txt -u http://127.0.0.2:8000/FUZZ
    ./ffuf -w common.txt -u http://127.0.0.2:8000/FUZZ -fs 154

![image](https://github.com/divrrv/Pentest/assets/112497215/22341a28-c3d9-4a4d-9339-bbdcebee950e)

    curl http://127.0.0.2:8000/wp-admin

![image](https://github.com/divrrv/Pentest/assets/112497215/6bd9e10e-ae57-4ae3-90b5-62d0bb05a2bc)




### b) Fuffme

#### Basic Content Discovery

![image](https://github.com/divrrv/Pentest/assets/112497215/fd5e7baf-2cd8-4122-8812-4ae45593dc0c)


#### Content Discovery With Recursion

![image](https://github.com/divrrv/Pentest/assets/112497215/958e0470-74ce-4d70-b96a-06332026d2c2)

#### Content Discovery With File Extensions

![image](https://github.com/divrrv/Pentest/assets/112497215/d4ed9e38-e1d7-470b-ab83-97ea03983f95)


#### No 404 Status

![image](https://github.com/divrrv/Pentest/assets/112497215/d2d1b66b-8d18-416a-8c5c-0fcb2b596652)


#### Param Mining

![image](https://github.com/divrrv/Pentest/assets/112497215/935f4015-2b1c-43a3-8ed2-3148dfbd2080)
![image](https://github.com/divrrv/Pentest/assets/112497215/1aff7a8a-e72e-4d4c-962c-a7daed036414)



#### Rate Limited

![image](https://github.com/divrrv/Pentest/assets/112497215/a6b7a1ea-7f5b-4dac-a41e-6cd27fabf4e8)


#### Subdomains - Virtual Host Enumeration

![image](https://github.com/divrrv/Pentest/assets/112497215/0fe2e87d-29fb-4803-9728-f9308a060152)


### c) nmap TCP connect scan -sT

![image](https://github.com/divrrv/Pentest/assets/112497215/ebc8a0f6-a723-4d41-bde4-87f562ff600b)

![image](https://github.com/divrrv/Pentest/assets/112497215/b7d9a269-6fc3-4271-8738-781e6aad3ef6)

### d) nmap TCP SYN "used to be stealth" scan, -sS

![image](https://github.com/divrrv/Pentest/assets/112497215/e3372dad-4e2e-4828-a8a1-46a7325249ba)

![image](https://github.com/divrrv/Pentest/assets/112497215/07637d9a-2004-42e7-bd28-73b665feea3e)

### e) nmap ping sweep -sn

![image](https://github.com/divrrv/Pentest/assets/112497215/bc0a74c6-64c4-4cf4-96d1-71705e446b76)

![image](https://github.com/divrrv/Pentest/assets/112497215/c0c9078e-3c0d-4402-9afc-59a9d5cd8fcf)

### f) nmap don't ping -Pn

![image](https://github.com/divrrv/Pentest/assets/112497215/48813beb-bbd3-4dda-8d99-afa67e079b2c)

![image](https://github.com/divrrv/Pentest/assets/112497215/83df78d2-4053-4721-95bb-8fafdf3a84bb)


### g) nmap version detection -sV

![image](https://github.com/divrrv/Pentest/assets/112497215/ed595187-253b-4335-b37a-a542717f8254)

![image](https://github.com/divrrv/Pentest/assets/112497215/a5c39d54-e62b-499a-87a8-6d58c2f833c3)

### h) nmap output files -oA foo

![image](https://github.com/divrrv/Pentest/assets/112497215/3672b4d1-f3fe-4486-82b8-3ea11f1c0710)

![image](https://github.com/divrrv/Pentest/assets/112497215/1f849946-a778-408a-9f70-18d4f4795de7)

![image](https://github.com/divrrv/Pentest/assets/112497215/1e97ef97-daa5-45f7-b8fb-8881b88cafd9)

#### skannauksen tulos oli jaettuna näihin 3 tiedostoon

### i) nmap ajonaikaiset toiminnot

![image](https://github.com/divrrv/Pentest/assets/112497215/5744d087-3a90-408a-b926-ca702463ecb0)

![image](https://github.com/divrrv/Pentest/assets/112497215/70fcd1b5-7f86-436c-bbbd-2f8a6d7d0940)


### j) Ninjojen tapaan

#### Asensin apachen ja käynnistin komennoilla:

    sudo apt-get update
    sudo apt-get install apache2
    sudo systemctl start apache2
    sudo systemctl status apache2

![image](https://github.com/divrrv/Pentest/assets/112497215/2bf1fbc4-b510-4de6-a255-56e079596d8a)

    nmap -A localhost

![image](https://github.com/divrrv/Pentest/assets/112497215/7a0d0d67-8e70-46a6-ad02-03b0b937e9f2)

#### wireshark

![image](https://github.com/divrrv/Pentest/assets/112497215/c019916a-c389-4817-b9a9-5ea420e23329)

#### apache.log
![image](https://github.com/divrrv/Pentest/assets/112497215/cd878d6b-7c9c-4a77-842b-9d29f7af6033)

#### nmap-skannaus ei piiloudu palvelimelta hyvin, kuten kuvista huomaa apachen lokiin on jäänyt tieto skannauksesta.

### k) UDP-skannaus

![image](https://github.com/divrrv/Pentest/assets/112497215/46a083d8-cd6f-4c69-8113-d68655ab6323)

![image](https://github.com/divrrv/Pentest/assets/112497215/397ce0f3-e3d4-443c-89a5-0b7dc6fe0f3c)

 - UDP skannaus etsi käynnissä olevat palvelut porteista ja ne löytyivät porteista 631/5353 loput palauttivat tavoittamattomissa.

### l) Miksi UDP-skannaus on hankalaa ja epäluotettavaa? [lähde](https://nmap.org/book/scan-methods-udp-scan.html)

 - Palomuurit ja suodattimet voivat pudottaa UDP-paketteja vastaamatta niihin, mikä vaikeuttaa skannauksen tulosten tulkintaa.
 - --reason flagi antaa lisätietoa skannauksen tuloksista joka auttaa skannauksen ymmärtämisessä.
 - Snifferin käyttö auttaa havaitsemaan ja tulkitsemaan tietoliikennettä.

### Lähteet

 - https://terokarvinen.com/2023/eettinen-hakkerointi-2023/#h2-sniff-n-scan
 - https://nmap.org/book/scan-methods-udp-scan.html
